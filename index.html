<!DOCTYPE html><html lang="zh-HK"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>å¿ƒæƒ…æ—¥è¨˜</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><link href="https://fonts.googleapis.com/css2?family=cwTeXYen&display=swap" rel="stylesheet"><style>    :root {        --primary: #ff9800; /* Orange */        --secondary: #ffecb3; /* Light Yellow */        --accent: #4caf50; /* Green */        --bg: #fff8e1;        --text: #5d4037;    }    body {        font-family: 'cwTeXYen', "Microsoft JhengHei", sans-serif;        background-color: var(--bg);        color: var(--text);        margin: 0;        padding: 20px;        background-image: radial-gradient(#ffe0b2 15%, transparent 16%);        background-size: 20px 20px;        user-select: none;     }    .container {        max-width: 800px;        margin: 0 auto;        background: white;        border: 4px dashed var(--primary);        border-radius: 30px;        padding: 30px;        box-shadow: 0 10px 0 rgba(0,0,0,0.1);    }    h1 {        text-align: center;        font-size: 2.5rem;        color: var(--primary);        margin-top: 0;        text-shadow: 2px 2px 0 #ffe0b2;    }    /* SECTIONS */    .section {        background: #fff;        border: 2px solid #eee;        border-radius: 20px;        padding: 20px;        margin-bottom: 25px;        transition: transform 0.2s;    }    .section:hover { border-color: var(--secondary); }    h3 { margin-top: 0; color: #8d6e63; font-size: 1.5rem; }    /* INPUTS */    input, select, textarea {        width: 100%;        padding: 15px;        border: 2px solid #ddd;        border-radius: 15px;        font-size: 1.3rem;        font-family: inherit;        box-sizing: border-box;        background: #fafafa;        outline: none;    }    input:focus, textarea:focus { border-color: var(--primary); background: #fffde7; }    /* SPEECH BUTTONS */    .speech-controls { display: flex; flex-direction: column; gap: 10px; }        .btn-mic {        background: #ff5252; color: white; border: none;        padding: 18px; border-radius: 15px; font-size: 1.3rem;        cursor: pointer; width: 100%; display: flex; justify-content: center; align-items: center; gap: 10px;        box-shadow: 0 5px 0 #b71c1c; margin-bottom: 5px;        transition: all 0.1s;    }    .btn-mic:active { transform: translateY(4px); box-shadow: 0 1px 0 #b71c1c; }        .btn-mic.recording {         background: #d32f2f;         animation: pulse 1.5s infinite;         box-shadow: 0 0 15px #ff5252;    }        .btn-read {        background: #42a5f5; color: white; border: none;        padding: 15px; border-radius: 15px; font-size: 1.2rem;        cursor: pointer; width: 100%; display: flex; justify-content: center; align-items: center; gap: 10px;        box-shadow: 0 5px 0 #1565c0; margin-top: 10px;        transition: all 0.1s;    }    .btn-read:active { transform: translateY(4px); box-shadow: 0 1px 0 #1565c0; }    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }    /* DRAWING AREA */    .instruction-text {        text-align: center; color: #555; font-size: 1.2rem; margin-bottom: 15px;        background: #e0f2f1; padding: 15px; border-radius: 15px; border: 1px dashed #4db6ac;    }    .tool-box {        display: flex; gap: 15px; justify-content: center; margin-bottom: 15px;    }    .tool-btn {        flex: 1; padding: 15px; border: 3px solid #eee; border-radius: 15px;        background: white; font-size: 1.2rem; cursor: pointer; text-align: center;        transition: all 0.1s;        box-shadow: 0 4px 0 #ddd;    }    .tool-btn:active { transform: translateY(4px); box-shadow: none; }    .tool-btn.active { border-color: var(--primary); background: #fff3e0; color: var(--primary); font-weight: bold; transform: translateY(2px); box-shadow: 0 2px 0 #ccc; }    /* COLOR PALETTE */    .color-row {        display: flex; justify-content: center; gap: 15px; margin-bottom: 15px;        background: #fff8e1; padding: 10px; border-radius: 20px;    }        .color-btn {        width: 45px; height: 45px; border-radius: 50%; cursor: pointer;        border: 3px solid white; box-shadow: 0 3px 5px rgba(0,0,0,0.2);        transition: transform 0.2s;    }    .color-btn:active { transform: scale(0.9); }    .color-btn.active { border-color: #333; transform: scale(1.1); }    /* Custom Color Picker input styling */    .color-picker-wrapper {        width: 45px; height: 45px; border-radius: 50%; overflow: hidden;        border: 3px solid white; box-shadow: 0 3px 5px rgba(0,0,0,0.2);        cursor: pointer; background: conic-gradient(red, yellow, lime, aqua, blue, magenta, red);    }    input[type="color"] {        width: 150%; height: 150%; margin: -25%; padding: 0; border: none; cursor: pointer; opacity: 0;    }    canvas {        border: 3px solid #ccc; border-radius: 15px; background: white;         cursor: crosshair; touch-action: none; display: block; width: 100%;        background-image: radial-gradient(#eee 10%, transparent 11%);        background-size: 20px 20px;    }    /* SAVE BTN */    .btn-save {        width: 100%; background: var(--accent); color: white; border: none;        padding: 20px; font-size: 1.5rem; border-radius: 20px; cursor: pointer;        box-shadow: 0 8px 0 #2e7d32; font-family: inherit; transition: all 0.1s;    }    .btn-save:active { transform: translateY(8px); box-shadow: none; }</style></head><body><div class="container">    <h1>ğŸŒ å¿ƒæƒ…æ—¥è¨˜</h1>    <div class="section">        <h3>ğŸ“… æ—¥æœŸèˆ‡åœ°é»</h3>        <input type="date" id="dateInput" style="margin-bottom: 10px;" onclick="playPop()">        <select id="locationSelect" onchange="checkLocation(); playPop();">            <option value="å­¸æ ¡">ğŸ« å­¸æ ¡</option>            <option value="å±‹ä¼">ğŸ  å±‹ä¼</option>            <option value="å…¬åœ’">ğŸŒ³ å…¬åœ’</option>            <option value="other">âœï¸ å…¶ä»–...</option>        </select>        <input type="text" id="locationOther" style="display:none; margin-top:10px;" placeholder="è«‹è¼¸å…¥åœ°é»">    </div>    <div class="section">        <h3>ğŸ—£ï¸ äº‹æƒ…</h3>        <div class="speech-controls">            <button class="btn-mic" id="micBtn" onclick="toggleMic()">                <i class="fas fa-microphone-alt"></i> æŒ‰æ­¤èªªè©± (èªéŸ³è¼¸å…¥)            </button>            <textarea id="eventText" rows="4" placeholder="è«‹è®€å‡ºä»Šå¤©ç™¼ç”Ÿçš„äº‹æƒ…..."></textarea>            <button class="btn-read" onclick="speak(); playPop();">                <i class="fas fa-volume-up"></i> æœ—è®€ (æª¢æŸ¥æ–‡å­—)            </button>        </div>    </div>    <div class="section">        <h3>ğŸ¨ å¿ƒæƒ…ç•«æ¿</h3>        <div class="instruction-text">            <i class="fas fa-hand-pointer"></i> ä½ å¯ä»¥é¸æ“‡ä»£è¡¨ä½ çš„å¿ƒæƒ…åœ–æ¡ˆæˆ–ç•«åœ¨ç•«æ¿ä¸Šã€‚        </div>        <div class="tool-box">            <div class="tool-btn active" id="btnBrush" onclick="setTool('brush'); playPop();">                <i class="fas fa-paint-brush"></i> ç•«ç­†            </div>            <div class="tool-btn" id="btnEraser" onclick="setTool('eraser'); playPop();">                <i class="fas fa-eraser"></i> æ“¦è†             </div>            <div class="tool-btn" style="color:#d32f2f;" onclick="clearCanvas(); playPop();">                <i class="fas fa-trash"></i> æ¸…é™¤            </div>        </div>        <div class="color-row">            <div class="color-btn active" style="background:#000000" onclick="setColor('#000000', this)"></div>            <div class="color-btn" style="background:#e74c3c" onclick="setColor('#e74c3c', this)"></div>            <div class="color-btn" style="background:#3498db" onclick="setColor('#3498db', this)"></div>            <div class="color-btn" style="background:#2ecc71" onclick="setColor('#2ecc71', this)"></div>            <div class="color-btn" style="background:#f39c12" onclick="setColor('#f39c12', this)"></div>            <div class="color-picker-wrapper" title="è‡ªè¨‚é¡è‰²">                <input type="color" onchange="setColor(this.value, this.parentNode)">            </div>        </div>        <div style="display:flex; gap:10px; overflow-x:auto; padding-bottom:10px; margin-bottom:10px;">             <button class="tool-btn" onclick="setSticker('ğŸ˜€'); playPop();">ğŸ˜€</button>             <button class="tool-btn" onclick="setSticker('ğŸ˜¢'); playPop();">ğŸ˜¢</button>             <button class="tool-btn" onclick="setSticker('ğŸ˜¡'); playPop();">ğŸ˜¡</button>             <button class="tool-btn" onclick="setSticker('ğŸ¥°'); playPop();">ğŸ¥°</button>             <button class="tool-btn" onclick="setSticker('ğŸ˜´'); playPop();">ğŸ˜´</button>             <button class="tool-btn" onclick="setSticker('ğŸ‰'); playPop();">ğŸ‰</button>        </div>        <canvas id="canvas" width="800" height="400"></canvas>    </div>    <button class="btn-save" onclick="saveFiles(); playPop();">ğŸ’¾ å„²å­˜æ—¥è¨˜</button></div><audio id="popSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio><script>    // --- 0. SOUND EFFECT ---    function playPop() {        const audio = document.getElementById('popSound');        audio.currentTime = 0;        audio.play().catch(e => console.log("Audio play blocked")); // Catch auto-play block    }    // --- 1. SETUP ---    document.getElementById('dateInput').valueAsDate = new Date();    const canvas = document.getElementById('canvas');    const ctx = canvas.getContext('2d');        // Default Canvas Settings    ctx.fillStyle = "white";     ctx.fillRect(0,0,800,400);     ctx.lineCap = "round";     ctx.lineJoin = "round";        // --- 2. DRAWING LOGIC ---    let mode = 'brush';     let sticker = '';    let isDrawing = false;    let currentColor = '#000000'; // Track current color    function setTool(t) {        mode = t;        document.getElementById('btnBrush').className = t==='brush' ? 'tool-btn active' : 'tool-btn';        document.getElementById('btnEraser').className = t==='eraser' ? 'tool-btn active' : 'tool-btn';    }    function setColor(color, btn) {        currentColor = color;        playPop();                // Visual Active State for Colors        if(btn && !btn.classList.contains('color-picker-wrapper')) {            document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));            btn.classList.add('active');        }        // Auto-switch to brush if using eraser        if(mode === 'eraser' || mode === 'sticker') {            setTool('brush');        }    }    function setSticker(s) {        mode = 'sticker';        sticker = s;        // Simple visual feedback        const msg = document.createElement('div');        msg.innerText = "å·²é¸æ“‡ " + s + " (é»æ“Šç•«æ¿è²¼ä¸Š)";        msg.style.cssText = "position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,0.8); color:white; padding:20px; border-radius:10px; z-index:999;";        document.body.appendChild(msg);        setTimeout(() => msg.remove(), 1000);    }    function clearCanvas() {        ctx.fillStyle = "white";         ctx.fillRect(0,0,800,400);    }    // DRAWING EVENTS    function getPos(e) {        const r = canvas.getBoundingClientRect();        const tx = (e.touches ? e.touches[0].clientX : e.clientX) - r.left;        const ty = (e.touches ? e.touches[0].clientY : e.clientY) - r.top;        return { x: tx * (canvas.width/r.width), y: ty * (canvas.height/r.height) };    }    function start(e) {        e.preventDefault();        const p = getPos(e);        if(mode === 'sticker') {            playPop();             ctx.font = "80px Arial"; ctx.textAlign="center"; ctx.textBaseline="middle";            ctx.fillStyle = "black";            ctx.fillText(sticker, p.x, p.y);        } else {            isDrawing = true;            ctx.beginPath(); ctx.moveTo(p.x, p.y);            // Apply Logic            if(mode === 'eraser') {                ctx.lineWidth = 30;                ctx.strokeStyle = 'white';            } else {                ctx.lineWidth = 5;                ctx.strokeStyle = currentColor; // Use selected color            }        }    }    function move(e) {        if(!isDrawing || mode==='sticker') return;        e.preventDefault();        const p = getPos(e);        ctx.lineTo(p.x, p.y); ctx.stroke();    }    function end() { isDrawing = false; }    canvas.addEventListener('mousedown', start); canvas.addEventListener('mousemove', move); canvas.addEventListener('mouseup', end);    canvas.addEventListener('touchstart', start); canvas.addEventListener('touchmove', move); canvas.addEventListener('touchend', end);    // --- 3. SPEECH TO TEXT ---    let recognition;    let isRecording = false;    if('webkitSpeechRecognition' in window) {        recognition = new webkitSpeechRecognition();        recognition.lang = "zh-HK";         recognition.continuous = true;         recognition.interimResults = true;         recognition.onstart = () => {             isRecording = true;            playPop();            const btn = document.getElementById('micBtn');            btn.classList.add('recording');            btn.innerHTML = '<i class="fas fa-stop-circle"></i> æ”¶éŸ³ä¸­... (æŒ‰æ­¤åœæ­¢)';        };                recognition.onend = () => {             isRecording = false;            const btn = document.getElementById('micBtn');            btn.classList.remove('recording');            btn.innerHTML = '<i class="fas fa-microphone-alt"></i> æŒ‰æ­¤èªªè©± (èªéŸ³è¼¸å…¥)';        };                recognition.onresult = (e) => {             let final = "";            for (let i = e.resultIndex; i < e.results.length; ++i) {                if (e.results[i].isFinal) {                    final += e.results[i][0].transcript;                }            }            if(final) document.getElementById('eventText').value += final;        };    }    function toggleMic() {        if(!recognition) return alert("è«‹ä½¿ç”¨ Google Chrome ç€è¦½å™¨");        if(isRecording) recognition.stop();        else recognition.start();    }    // --- 4. TEXT TO SPEECH ---    function speak() {        const txt = document.getElementById('eventText').value;        if(!txt) return;        const u = new SpeechSynthesisUtterance(txt);        u.lang = 'zh-HK';        u.rate = 0.9;         u.pitch = 1.0;         const voices = window.speechSynthesis.getVoices();        // Priority: Google Cantonese -> Any HK -> Any        const bestVoice = voices.find(v => v.name.includes("Google") && v.lang.includes("HK"))                        || voices.find(v => v.lang.includes("HK"));                if(bestVoice) u.voice = bestVoice;        window.speechSynthesis.speak(u);    }    // --- 5. EXPORT ---    function checkLocation() { document.getElementById('locationOther').style.display = document.getElementById('locationSelect').value==='other'?'block':'none'; }        function saveFiles() {        const date = document.getElementById('dateInput').value;        let loc = document.getElementById('locationSelect').value;        if(loc==='other') loc = document.getElementById('locationOther').value;        const txt = document.getElementById('eventText').value;                const csv = "\uFEFF" + `æ—¥æœŸ,åœ°é»,äº‹æƒ…\n${date},${loc},${txt}`;        const l1 = document.createElement('a'); l1.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'})); l1.download=`Diary_${date}.csv`; l1.click();        setTimeout(()=>{            const l2 = document.createElement('a'); l2.href=canvas.toDataURL('image/jpeg'); l2.download=`Drawing_${date}.jpg`; l2.click();        },500);    }</script></body></html>